<!DOCTYPE html>
<html lang="en">
<h2>HEADING</h2>
  <body>
    <form onsubmit="saveToLocalStroage(event)">
    <label>name</label>
    <input type="text" name="usernam" required/>
    <label>email</label>
    <input type="email" name="emai" required/>
    <lable>phone no</lable>
    <input type="tel" name="phonenumbr" >
    <button>submit</button>
    </form>
     <ul id='listOfItems'></ul>
  <script language="JavaScript" type="text/javascript" >
      function saveToLocalStroage(event){
         event.preventDefault();
             const name=event.target.usernam.value;
               const mail=event.target.emai.value;
               const phone=event.target.phonenumbr.value;
             // console.log(name);

           const obj={
                 name,
              mail,
              phone
               }
            // localStorage.setItem(obj.mail, JSON.stringify(obj))
           axios.post("https://crudcrud.com/api/a33fb16a7de248df9c4260bbd7a79e3e/AppointmentData",obj).then(res =>{
            console.log(res);
            showOnScreen(res.data);
           }).catch((err)=>{
             console.log(err);
           })

            // showOnScreen(obj)
             }
             window.addEventListener("DOMcontentLoaded",()=>{
              axios.get("https://crudcrud.com/api/a33fb16a7de248df9c4260bbd7a79e3e").then((response)=>{
                console.log(response);
                for(var i=0; i<response.data.length; i++)
                {
                  showOnScreen(response.data[i]);
                }
              }).catch(err=>console.log(err)
            )
             })
             document.addEventListener('DOMContentLoaded', function() {
  var deleteButtons = document.querySelectorAll('.delete-user');
  for (var i = 0; i < deleteButtons.length; i++) {
    deleteButtons[i].addEventListener('click', function(event) {
      var userId = event.target.dataset.userId;
      var xhr = new XMLHttpRequest();
      xhr.open('DELETE', '/users/' + userId);
      xhr.onload = function() {
        if (xhr.status === 200) {
          var userDetail = document.getElementById('user-detail-' + userId);
          userDetail.parentNode.removeChild(userDetail);
        } else {
          alert('Error deleting user');
        }
      };
      xhr.send();
    });
  }
});

               function showOnScreen(obj){
                  const parentEme=document.getElementById('listOfItems')
              const childEle=document.createElement('li')
              childEle.textContent=obj.name +'  -   '+ obj.mail +'  -  '+obj.phone
              

              const deleteButton=document.createElement('input')
              deleteButton.type="button"
              deleteButton.value='delete'
              deleteButton.onclick =() => {
                localStorage.removeItem(obj.mail)
                parentEme.removeChild(childEle)

              }
              const editButton=document.createElement('input')
              editButton.type="button"
              editButton.value='edit'
              editButton.onclick=() =>{
                localStorage.removeItem(obj.mail)
               parentEme.removeChild(childEle)
               document.getElementById('usernamInputTag').value=obj.name
               document.getElementById('emaiInputTag').value=obj.mail
               document.getElementById('phoneInputTag').value=obj.phone
              }
               childEle.appendChild(editButton) 
              childEle.appendChild(deleteButton)
              parentEme.appendChild(childEle)
               }
      </script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>
  </body>
</html>
